<!DOCTYPE HTML>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title></title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <base href="">

        <link rel="stylesheet" href="book.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <link rel="shortcut icon" href="favicon.png">

        <!-- Font Awesome -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme -->
        

        

        <!-- Fetch Clipboard.js from CDN but have a local fallback -->
        <script src="https://cdn.jsdelivr.net/clipboard.js/1.6.1/clipboard.min.js"></script>
        <script>
            if (typeof Clipboard == 'undefined') {
                document.write(unescape("%3Cscript src='clipboard.min.js'%3E%3C/script%3E"));
            }
        </script>

    </head>
    <body class="light">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { } 
            if (theme === null || theme === undefined) { theme = 'light'; }
            document.body.className = theme;
            document.querySelector('html').className = theme;
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            document.querySelector('html').classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <ol class="chapter"><li><a href="lecture_01_02.html"><strong aria-hidden="true">1.</strong> Lecture 1 &amp; 2</a></li><li><a href="lecture_03_04.html"><strong aria-hidden="true">2.</strong> Lecture 3 &amp; 4</a></li><li><a href="big_project.html"><strong aria-hidden="true">3.</strong> Big Project</a></li></ol>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar" class="menu-bar">
                    <div id="menu-bar-sticky-container">
                        <div class="left-buttons">
                            <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                                <i class="fa fa-bars"></i>
                            </button>
                            <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                                <i class="fa fa-paint-brush"></i>
                            </button>
                            <ul id="theme-list" class="theme-popup" aria-label="submenu">
                                <li><button class="theme" id="light">Light <span class="default">(default)</span></button></li>
                                <li><button class="theme" id="rust">Rust</button></li>
                                <li><button class="theme" id="coal">Coal</button></li>
                                <li><button class="theme" id="navy">Navy</button></li>
                                <li><button class="theme" id="ayu">Ayu</button></li>
                            </ul>
                        </div>

                        <h1 class="menu-title"></h1>

                        <div class="right-buttons">
                            <a href="print.html" title="Print this book" aria-label="Print this book">
                                <i id="print-button" class="fa fa-print"></i>
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <p>Hello everyone!</p>
<p>A quick mail about &quot;Systems and networks programming in Rust” lecture, read it entirely, there is some homework for you at the end. You will find a French version of this mail bellow ;)</p>
<a class="header" href="print.html#recap-from-the-previous-sessions" id="recap-from-the-previous-sessions"><h1>Recap from the previous sessions</h1></a>
<a class="header" href="print.html#rust-basics-introduction-syntax-error-handling" id="rust-basics-introduction-syntax-error-handling"><h2>Rust basics (Introduction, Syntax, Error Handling):</h2></a>
<ul>
<li>
<ol start="0">
<li>Schedule, purpose, and rules of the class (planning, assignments, grades, etc..)</li>
</ol>
</li>
<li>
<ol>
<li>What's systems programming? Why systems (and networks) programming? Why Rust?</li>
</ol>
</li>
<li>
<ol start="2">
<li>Setup a Rust dev environment with https://rustup.rs, and a code editor (https://www.rust-lang.org/tools) with RLS support (https://github.com/rust-lang/rls) and be sure to not have just the VSCode extension but to install it with command <code>rustup component add rls rust-analysis rust-src</code></li>
</ol>
</li>
</ul>
<p>N.B. People on Windows should read this https://github.com/rust-lang/rustup.rs/#working-with-rust-on-windows, and installing Visual Studio C/C++ tools suite (like link.exe to link program) using Visual Studio Installer.</p>
<p>I also recommend to get you a WLS and install Rust with rustup in bash.exe, since starting from course 3 we will play with Linux file abstraction.</p>
<ul>
<li>
<ol start="3">
<li>Get familiar with language syntax by playing a bit with https://github.com/rust-lang/rustlings</li>
</ol>
</li>
<li>
<ol start="4">
<li>Theoretical recap about the semantics of a Rust program (we talk about functions VS macros, type inference, enumeration types https://doc.rust-lang.org/std/result/enum.Result.html)</li>
</ol>
</li>
<li>
<ol start="5">
<li>Show off basic tooling: how to create a binary/library with cargo, how to add a dependency form crate.io to our project, we start writing a little MASTERMIND game (Here is a link to the full implementation https://github.com/yvan-sraka/mymastermind)</li>
</ol>
</li>
</ul>
<p>Further information could be found in THE RUST BOOK —&gt; https://doc.rust-lang.org/stable/book/ &lt;— (what we do in class match the 3 first chapters of the book)</p>
<a class="header" href="print.html#rust-advanced-static-automated-memory-management-ownership--borrowing" id="rust-advanced-static-automated-memory-management-ownership--borrowing"><h2>Rust advanced (static automated memory management: Ownership &amp; Borrowing)</h2></a>
<ul>
<li>
<p>QCM is a huge success, the mean of the class is 13,67 / 20 (negative points are on me this time)</p>
</li>
<li>
<p>I strongly advise you to try to finish rustlings to be more comfortable with basic language features https://github.com/rust-lang/rustlings</p>
</li>
<li>
<p>The small Rust code I wrote in class to play with ownership and borrowing: https://gist.github.com/yvan-sraka/81f3f6ea6e7147b69a334b023d71f0bb</p>
</li>
</ul>
<p>REMINDER: Rule of thumbs of Rust -&gt; they cannot have both aliasing AND mutability!</p>
<a class="header" href="print.html#program-of-the-next-lectures" id="program-of-the-next-lectures"><h1>Program of the next lectures</h1></a>
<ul>
<li>December 20: Files (standard IO, synchronous message through pipes), Tasks (process, thread) and other POSIX stuff</li>
<li>January  10: No class!</li>
<li>January  24: FFI, unsafe world (let’s talk about “lifetimes”) and the C runtime</li>
<li>2nd Semester: ***** NETWORK (finally, something fun) *****</li>
</ul>
<a class="header" href="print.html#mandatory-for-the-next-session-december-20" id="mandatory-for-the-next-session-december-20"><h1>Mandatory for the next session (December 20)</h1></a>
<p>/!\ Have a UNIX system with Rust installed inside:</p>
<p>For those that run a Windows machine, I highly recommend the installation of a WSL (Windows Subsystem for Linux) https://docs.microsoft.com/en-us/windows/wsl/install-win10</p>
<p>and the nice VSCode extension https://code.visualstudio.com/remote-tutorials/wsl/run-in-wsl that allows you to run <code>code</code> command remotely in bash.exe shell!</p>
<p>(and, of course, to have a working Rust dev environment with RLS setup https://github.com/rust-lang/rls)</p>
<a class="header" href="print.html#go-deeper-into-rust" id="go-deeper-into-rust"><h1>Go deeper into Rust</h1></a>
<p>We, at this point cover, all of 6 first chapters, and most of 7, 8 and 9 of the Rust Book https://doc.rust-lang.org/stable/book/</p>
<p>We will not advance to much in Rust specific feature after this point (I will not make a class about trait e.g.), I let you free of learning more about it or not!</p>
<p>I give you here three handy tools that will help you with homework and graded project:</p>
<ul>
<li>https://github.com/rust-lang/rust-clippy</li>
<li>https://github.com/rust-lang/rustfmt</li>
<li>https://github.com/mre/cargo-inspect (play with it!)</li>
</ul>
<a class="header" href="print.html#go-deeper-into-memory" id="go-deeper-into-memory"><h1>Go deeper into memory</h1></a>
<p>Try to create a small C program that creates a memory leak (like a loop that malloc but never free) and open it in Valgrind, translates the program in Rust and redo the test.</p>
<p>Do you know that the program stack has a fixed space size in memory? What’s happen when you fill it all with function calls? -&gt; a stack overflow!</p>
<p>You can look at this minimalist malloc implementation from mine, using mmap syscall (read its man) to allocate memory pages: https://github.com/yvan-sraka/malloc</p>
<p>Supplementary links to feed your curiosity (bonus, not mandatory):</p>
<ul>
<li>There no null pointers in Rust! Why? Watch “Null References: The Billion Dollar Mistake” from Tony Hoare https://www.infoq.com/presentations/Null-References-The-Billion-Dollar-Mistake-Tony-Hoare/</li>
<li>Some more readings for the brave: “What Every Programmer Should Know About Memory” by Ulrich Drepper from Red Hat https://people.freebsd.org/~lstewart/articles/cpumemory.pdf</li>
</ul>
<a class="header" href="print.html#homework-mandatory---deadline-push-it-before-the-class" id="homework-mandatory---deadline-push-it-before-the-class"><h2>Homework (mandatory) - deadline: push it before the class</h2></a>
<p>Make a PR (Pull-Request) on this repository that fixes this code: https://github.com/rust-esgi/base64decode/blob/master/src/main.rs</p>
<p>It will be automatically validated by GitHub Actions (Continuous Integration),</p>
<p>You can test your code by trying to decrypt this secret message:</p>
<p>TGEgcmFjbGV0dGUgKEJyYXRjaMOkcywgwqsgZnJvbWFnZSDCuyByw7R0aSwgZW4gc3Vpc3NlIGFsbGVtYW5kKSBlc3QgZCd1bmUgcGFydCB1biBmcm9tYWdlIChsZSBvdSBsYSByYWNsZXR0ZSkgb3JpZ2luYWlyZSBkdSBjYW50b24gZHUgVmFsYWlzIGVuIFN1aXNzZSwgZXQgZCdhdXRyZSBwYXJ0LCB1bmUgcmVjZXR0ZSBkZSBjdWlzaW5lIHRyYWRpdGlvbm5lbGxlIGV0IGVtYmzDqW1hdGlxdWUgZGUgbGEgY3Vpc2luZSBzdWlzc2UsIGNvbm51ZSBkYW5zIGxlIG1vbmRlIGVudGllciwgdmFyaWFudGUgZGVzIGZvbmR1ZXMgYXUgZnJvbWFnZSwgw6AgYmFzZSBkZSBjZSBmcm9tYWdlIGZvbmR1LCByYWNsw6kgYXUgZnVyIGV0IMOgIG1lc3VyZSBxdeKAmWlsIGZvbmQsIGV0IHNlcnZpZSB0cmFkaXRpb25uZWxsZW1lbnQgYXZlYyBkZXMgcG9tbWVzIGRlIHRlcnJlIGVuIHJvYmUgZGVzIGNoYW1wcyBldCBhY2NvbXBhZ27DqWUgZGUgbMOpZ3VtZXMgYXUgdmluYWlncmUgKGNvcm5pY2hvbnMsIG9pZ25vbnMpLg==</p>
<a class="header" href="print.html#big-project" id="big-project"><h1>Big Project</h1></a>
<p>I will present during the next class the final project on which you will be evaluated. You’re free to come with your idea of an alternative project if you have already in mind something that you want to code in Rust. I will accept any idea that could be reasonably doable by a group of 3 or 4 students (chosen randomly), that implies features specific to systems or networks programming (think about playing with binary encoding, intense computing with concurrent programming, low-level binding with another library or just any funny syscalls, etc…)!</p>
<p>Cheers, Yvan</p>
<hr />
<p>Bonjour à tous!</p>
<p>L’anglais ce n’est pas votre truc, je ne vous en veux pas :)</p>
<a class="header" href="print.html#récapitulatif-des-sessions-précédentes" id="récapitulatif-des-sessions-précédentes"><h1>Récapitulatif des sessions précédentes</h1></a>
<a class="header" href="print.html#notions-de-base-sur-rust-introduction-syntaxe-traitement-des-erreurs" id="notions-de-base-sur-rust-introduction-syntaxe-traitement-des-erreurs"><h2>Notions de base sur Rust (Introduction, Syntaxe, Traitement des erreurs):</h2></a>
<ul>
<li>
<ol start="0">
<li>Horaires, but et règles de la classe (planning, devoirs maisons, notes, etc.)</li>
</ol>
</li>
<li>
<ol>
<li>Qu'est-ce que la programmation système ? Pourquoi programmer des systèmes (et des réseaux) ? Pourquoi Rust ?</li>
</ol>
</li>
<li>
<ol start="2">
<li>Configurez un environnement de développement Rust avec https://rustup.rs et un IDE (https://www.rust-lang.org/tools) avec support RLS (https://github.com/rust- lang / rls) vous avez besoin de l'extension VSCode, mais de lancer cette commande <code>rustup component add rls rust-analysis rust-src</code></li>
</ol>
</li>
</ul>
<p>N.B. Les utilisateurs de Windows doivent lire ce guide https://github.com/rust-lang/rustup.rs/#working-with-rust-on-windows et installer la suite d'outils Visual Studio C / C++ (contenant par exemple link.exe) à l’aide de Visual Studio Installer.</p>
<p>Je vous recommande également de vous procurer un WLS et d’installer Rust avec rustup dans bash.exe, puisqu’à partir du cours 3, nous allons jouer avec l’abstraction de fichiers Linux.</p>
<ul>
<li>
<ol start="3">
<li>Familiarisez-vous avec la syntaxe du langage en jouant un peu avec https://github.com/rust-lang/rustlings</li>
</ol>
</li>
<li>
<ol start="4">
<li>Récapitulation théorique de la sémantique d'un programme Rust (on a parlé de fonctions VS macros, d’inférence de types, d'énumérations https://doc.rust-lang.org/std/result/enum.Result.html)</li>
</ol>
</li>
<li>
<ol start="5">
<li>Les outils de base : comment créer une bibliothèque / binaire avec cargo, comment ajouter une dépendance crate.io à notre projet, nous avons commencé à écrire un petit jeu MASTERMIND (voici un lien vers l’implémentation complète https://github.com/yvan-sraka/mymastermind)</li>
</ol>
</li>
</ul>
<p>Des informations complémentaires sont disponibles dans THE RUST BOOK -&gt; https://doc.rust-lang.org/stable/book/&lt;- (ce que nous avons fait en classe correspond aux 3 premiers chapitres du livre)</p>
<a class="header" href="print.html#rust-avancé-gestion-automatique-de-la-mémoire-statique--ownership--et--borrowing-" id="rust-avancé-gestion-automatique-de-la-mémoire-statique--ownership--et--borrowing-"><h2>Rust avancé (gestion automatique de la mémoire statique: « ownership » et « borrowing »)</h2></a>
<ul>
<li>
<p>Le QCM est un énorme succès, la moyenne de la classe est de 13,67 / 20 (les points négatifs sont pour moi cette fois)</p>
</li>
<li>
<p>Je vous conseille vivement d'essayer de finir les exercices « rustlings » pour être plus à l'aise avec les fonctionnalités de base du langage https://github.com/rust-lang/rustlings</p>
</li>
<li>
<p>Le petit code Rust que j'ai écrit en classe pour jouer avec les concepts d’« ownership » et de « borrowing » : https://gist.github.com/yvan-sraka/81f3f6ea6e7147b69a334b023d71f0bb</p>
</li>
</ul>
<p>RAPPEL: règle d’or de Rust -&gt; il ne peut pas avoir à la fois de l’aliasing ET de la mutabilité!</p>
<a class="header" href="print.html#programme-des-prochaines-séances" id="programme-des-prochaines-séances"><h1>Programme des prochaines séances</h1></a>
<ul>
<li>
<p>19 décembre: fichiers (E / S standard, message synchrone via des pipes), tâches (processus, thread) et autres POSIXeries</p>
</li>
<li>
<p>10 janvier : Pas de cours !</p>
</li>
<li>
<p>24 janvier : FFI,  unsafe mode (parlons de « lifetimes ») et binaires</p>
</li>
<li>
<p>2nd Semestre : ***** NETWORK (enfin, quelque chose d'amusant) *****</p>
</li>
</ul>
<a class="header" href="print.html#obligatoire-pour-la-prochaine-session-20-décembre" id="obligatoire-pour-la-prochaine-session-20-décembre"><h1>Obligatoire pour la prochaine session (20 Décembre)</h1></a>
<p>/!\ Avoir un système UNIX avec Rust installé dessus :</p>
<p>Pour ceux qui exécutent une machine Windows, je recommande vivement l'installation d'un WSL (Sous-système Windows pour Linux) https://docs.microsoft.com/en-us/windows/wsl/install-win10</p>
<p>et de l’extension VSCode qui va bien https://code.visualstudio.com/remote-tutorials/wsl/run-in-wsl qui vous permet d'exécuter la commande <code>code</code> à distance dans un shell bash.exe!</p>
<p>(et, bien sûr, d’avoir un environnement de développement Rust fonctionnel avec RLS activé https://github.com/rust-lang/rls)</p>
<a class="header" href="print.html#aller-plus-loin-dans-rust" id="aller-plus-loin-dans-rust"><h1>Aller plus loin dans Rust</h1></a>
<p>Nous avons couvert jusqu’à présent les 6 premiers chapitres et la plupart des 7, 8 et 9 du Rust Book https://doc.rust-lang.org/stable/book/</p>
<p>Nous n’avancerons pas beaucoup dans les fonctionnalités spécifiques de Rust à partir de maintenant (je ne ferai, par exemple, pas de cours sur les traits), je vous laisse libre d’en apprendre davantage sur le sujet ou pas!</p>
<p>Je vous donne ici trois outils pratiques qui vous aideront avec vos devoirs et votre projet noté:</p>
<ul>
<li>https://github.com/rust-lang/rust-clippy</li>
<li>https://github.com/rust-lang/rustfmt</li>
<li>https://github.com/mre/cargo-inspect (jouez avec !)</li>
</ul>
<a class="header" href="print.html#aller-plus-loin-dans-la-mémoire" id="aller-plus-loin-dans-la-mémoire"><h1>Aller plus loin dans la mémoire</h1></a>
<p>Essayez de créer un petit programme en C qui crée une fuite de mémoire (comme une boucle qui « malloc » mais qui ne « free » jamais) et ouvrez-le dans Valgrind, traduisez le programme en Rust et refaites le test.</p>
<p>Savez-vous que la pile d’un programme a une taille fixe dans l’espace mémoire ? Que se passe-t-il lorsque vous dépassez l’espace disponible avec trop d’appels de fonction ? -&gt; « stack overflow » !</p>
<p>Vous pouvez regarder cette implémentation malloc minimaliste, basé sur l’appel système mmap (lisez son manuel) pour allouer des pages de mémoire : https://github.com/yvan-sraka/malloc</p>
<p>Quelques liens supplémentaires pour nourrir votre curiosité (en bonus, non obligatoire):</p>
<ul>
<li>Il n'y a pas de pointeurs « null » dans Rust! Pourquoi? Regardez “Null References: The Billion Dollar Mistake” de Tony Hoare https://www.infoq.com/presentations/Null-References-The-Billion-Dollar-Mistake-Tony-Hoare/</li>
<li>Quelques lectures supplémentaires pour les plus courageux: “What Every Programmer Should Know About Memory” de Ulrich Drepper chez Red Hat https://people.freebsd.org/~lstewart/articles/cpumemory.pdf</li>
</ul>
<a class="header" href="print.html#devoir-maison-obligatoire---date-limite-à-envoyer-avant-le-cours" id="devoir-maison-obligatoire---date-limite-à-envoyer-avant-le-cours"><h1>Devoir maison (obligatoire) - date limite: à envoyer avant le cours</h1></a>
<p>Créez une PR (Pull-Request) sur ce repos qui corrige les bugs de ce code: https://github.com/rust-esgi/base64decode</p>
<p>Il sera automatiquement validé par GitHub Actions (Intégration Continue), donc si c’est vert, vous avez déjà une bonne note. Je vous donnerai des points supplémentaires si vous parvenez à réduire la taille du code sans le casser!</p>
<p>Vous pouvez tester votre code en essayant de déchiffrer ce message secret:</p>
<p>TGEgcmFjbGV0dGUgKEJyYXRjaMOkcywgwqsgZnJvbWFnZSDCuyByw7R0aSwgZW4gc3Vpc3NlIGFsbGVtYW5kKSBlc3QgZCd1bmUgcGFydCB1biBmcm9tYWdlIChsZSBvdSBsYSByYWNsZXR0ZSkgb3JpZ2luYWlyZSBkdSBjYW50b24gZHUgVmFsYWlzIGVuIFN1aXNzZSwgZXQgZCdhdXRyZSBwYXJ0LCB1bmUgcmVjZXR0ZSBkZSBjdWlzaW5lIHRyYWRpdGlvbm5lbGxlIGV0IGVtYmzDqW1hdGlxdWUgZGUgbGEgY3Vpc2luZSBzdWlzc2UsIGNvbm51ZSBkYW5zIGxlIG1vbmRlIGVudGllciwgdmFyaWFudGUgZGVzIGZvbmR1ZXMgYXUgZnJvbWFnZSwgw6AgYmFzZSBkZSBjZSBmcm9tYWdlIGZvbmR1LCByYWNsw6kgYXUgZnVyIGV0IMOgIG1lc3VyZSBxdeKAmWlsIGZvbmQsIGV0IHNlcnZpZSB0cmFkaXRpb25uZWxsZW1lbnQgYXZlYyBkZXMgcG9tbWVzIGRlIHRlcnJlIGVuIHJvYmUgZGVzIGNoYW1wcyBldCBhY2NvbXBhZ27DqWUgZGUgbMOpZ3VtZXMgYXUgdmluYWlncmUgKGNvcm5pY2hvbnMsIG9pZ25vbnMpLg ==</p>
<a class="header" href="print.html#projet-final" id="projet-final"><h1>Projet final</h1></a>
<p>Lors du prochain cours, je présenterai le projet final sur lequel vous serez évalué. Vous êtes libre de proposer des idées de projets alternatifs si vous avez déjà en tête quelque chose que vous souhaitez coder dans Rust. J'accepterai toute idée raisonnablement réalisable par un groupe de 3 ou 4 étudiants (choisis au hasard), qui implique des fonctionnalités spécifiques à la programmation système ou réseau (pensez à jouer avec un encodage binaire, des programmes concurrents qui font des calculs, de l’interopérabilité bas niveau avec une autre bibliothèque ou des appels systèmes, etc ...)!</p>
<p>Amitiés, Yvan</p>
<p>Hello everybody,</p>
<p>Again, a too-long email, the french version is behind!</p>
<a class="header" href="print.html#-important" id="-important"><h1>/!\ IMPORTANT</h1></a>
<p>I intend to assign you grades and I need you to be sure that I have the good matching between your mails, GitHub IDs, and names:
https://docs.google.com/spreadsheets/d/1O8OsWIaI7GBfuLfFsIT0vmGJkdTsDXf9S7wYtnWxTW0/edit#gid=1685467236</p>
<a class="header" href="print.html#recap-from-the-last-session" id="recap-from-the-last-session"><h2>Recap from the last session</h2></a>
<ul>
<li>
<p>Recall previous episode:</p>
<ul>
<li>Rust philosophy &quot;zero-cost abstractions&quot; -&gt; play a bit with <code>cargo inspect</code>, <code>cargo fmt</code>, <code>cargo clippy</code></li>
</ul>
</li>
<li>
<p>Let's talk a bit about POSIX, UNIX, Linux, etc ... and file abstraction</p>
<ul>
<li>Named pipe example: <code>mkfifo</code> (to send a synchronous message)</li>
<li>What about serialization? Do you know protocol buffer? -&gt; https://developers.google.com/protocol-buffers
(SPOILER: shared memory is better) -&gt; https://capnproto.org</li>
</ul>
</li>
<li>
<p>A multi-thread parallel cat? https://gist.github.com/yvan-sraka/6b597ec60e679953f7cda9128724c522</p>
<ul>
<li>Talk about process scheduling, etc...</li>
<li>Show <code>htop</code> tree view, play with small tests using Valgrind / GDB</li>
</ul>
</li>
</ul>
<a class="header" href="print.html#to-go-further" id="to-go-further"><h2>To go further</h2></a>
<ul>
<li>Learn about File Descriptor https://en.wikipedia.org/wiki/File_descriptor</li>
<li>IOStream Is Hopelessly Broken https://www.moria.us/articles/iostream-is-hopelessly-broken/</li>
<li>Writing an OS in Rust https://os.phil-opp.com/</li>
<li>Why is a Rust executable large? https://lifthrasiir.github.io/rustlog/why-is-a-rust-executable-large.html</li>
<li>Smart pointers in Rust https://doc.rust-lang.org/book/ch15-00-smart-pointers.html</li>
<li>Rust sucks because ... https://wiki.theory.org/index.php/YourLanguageSucks#Rust_sucks_because</li>
</ul>
<a class="header" href="print.html#mandatory-homework" id="mandatory-homework"><h2>[MANDATORY] Homework</h2></a>
<p>You have to recode a small pipe-like program, working like this:</p>
<pre><code class="language-shell">$ mypipe --in fortune --out cowsay
</code></pre>
<pre><code> _______________________________________
/ Q: What's tiny and yellow and very,   \
| very, dangerous? A: A canary with the |
\ super-user password.                  /
 ---------------------------------------
          \   ^__^
           \  (oo)\_______
              (__)\       )\/\
                  ||----w |
                  ||     ||
</code></pre>
<p>You can use https://clap.rs to parse the command-line arguments, and also follow the guide https://rust-lang-nursery.github.io/cli-wg/</p>
<p>Upload your code by doing a PR here: https://github.com/rust-esgi/mypipe</p>
<a class="header" href="print.html#prepare-the-next-session-keep-talking-about-unix-tools-for-binaries-analysis" id="prepare-the-next-session-keep-talking-about-unix-tools-for-binaries-analysis"><h2>Prepare the next session (keep talking about Unix tools for binaries analysis)</h2></a>
<pre><code>* https://lldb.llvm.org
* https://godbolt.org
* https://en.wikipedia.org/wiki/Executable_and_Linkable_Format
* https://en.wikipedia.org/wiki/GNU_Binutils
* https://en.wikipedia.org/wiki/Strace
</code></pre>
<p>We will play with =&gt; FFI: Foreign Function Interface</p>
<p>I wish all of you to enjoy end-of-year celebrations.</p>
<p>Best, Yvan</p>
<hr />
<p>Bonjour tous le monde,</p>
<p>Encore une fois, un e-mail trop long:</p>
<a class="header" href="print.html#-important-1" id="-important-1"><h1>/!\ IMPORTANT</h1></a>
<p>Pour vous attribuer des notes, j'ai besoin d'avoir la bonne correspondance entre vos e-mails, identifiants GitHub et vos nom / prénom:
https://docs.google.com/spreadsheets/d/1O8OsWIaI7GBfuLfFsIT0vmGJkdTsDXf9S7wYtnWxTW0/edit#gid=0</p>
<a class="header" href="print.html#récapitulatif-du-dernier-cours" id="récapitulatif-du-dernier-cours"><h2>Récapitulatif du dernier cours</h2></a>
<ul>
<li>
<p>Rappel de l'épisode précédent:
    * La philosophie de Rust &quot;zero-cost abstractions&quot; -&gt; jouons un peu avec <code>cargo inspect</code>, <code>cargo fmt</code>, <code>cargo clippy</code></p>
</li>
<li>
<p>Parlons un peu de POSIX, UNIX, Linux, etc ... et de l'abstraction de fichiers
    * Exemple de pipe nommé: <code>mkfifo</code> (pour envoyer un message synchrone)
    * Qu'en est-il de la sérialisation? Connaissez-vous Protocol Buffer? -&gt; https://developers.google.com/protocol-buffers
        (SPOILER: la mémoire partagée c'est mieux) -&gt; https://capnproto.org</p>
</li>
<li>
<p>Un <code>cat</code> parallèle multi-threadé ? https://gist.github.com/yvan-sraka/6b597ec60e679953f7cda9128724c522
    * Parlons de la planification des processus, etc ...
    * <code>htop</code> en mode <code>tree view</code>, jouons avec de petits tests en utilisant Valgrind / GDB</p>
</li>
</ul>
<a class="header" href="print.html#pour-aller-plus-loin" id="pour-aller-plus-loin"><h2>Pour aller plus loin</h2></a>
<ul>
<li>Connaissez vous les descripteurs de fichier https://en.wikipedia.org/wiki/File_descriptor</li>
<li>IOStream est désespérément cassé https://www.moria.us/articles/iostream-is-hopelessly-broken/</li>
<li>Écrire un OS en Rust https://os.phil-opp.com/</li>
<li>Pourquoi un exécutable Rust est-il volumineux ? https://lifthrasiir.github.io/rustlog/why-is-a-rust-executable-large.html</li>
<li>Pointeurs intelligents dans Rust https://doc.rust-lang.org/book/ch15-00-smart-pointers.html</li>
<li>Rust est nul parce que ... https://wiki.theory.org/index.php/YourLanguageSucks#Rust_sucks_because</li>
</ul>
<a class="header" href="print.html#obligatoire-devoirs-pour-anticiper-la-prochaine-classe" id="obligatoire-devoirs-pour-anticiper-la-prochaine-classe"><h2>[OBLIGATOIRE] Devoirs pour anticiper la prochaine classe</h2></a>
<p>Vous devez recoder un petit programme de type pipe, fonctionnant comme ceci:</p>
<pre><code class="language-shell">$ mypipe --in fortune --out cowsay
</code></pre>
<pre><code> _______________________________________
/ Q: What's tiny and yellow and very,   \
| very, dangerous? A: A canary with the |
\ super-user password.                  /
 ---------------------------------------
          \   ^__^
           \  (oo)\_______
              (__)\       )\/\
                  ||----w |
                  ||     ||
</code></pre>
<p>Vous pouvez utiliser https://clap.rs pour analyser les arguments de ligne de commande, et suivre également le guide https://rust-lang-nursery.github.io/cli-wg/</p>
<p>Uploadez votre code en faisant une PR ici: https://github.com/rust-esgi/mypipe</p>
<a class="header" href="print.html#pour-préparer-le-prochain-cours-parlons-doutils-unix-pour-lanalyse-de-binaires" id="pour-préparer-le-prochain-cours-parlons-doutils-unix-pour-lanalyse-de-binaires"><h2>Pour préparer le prochain cours (parlons d'outils Unix pour l'analyse de binaires)</h2></a>
<p>    * https://lldb.llvm.org
    * https://godbolt.org
* https://en.wikipedia.org/wiki/Executable_and_Linkable_Format
* https://en.wikipedia.org/wiki/GNU_Binutils
    * https://en.wikipedia.org/wiki/Strace</p>
<p>Nous allons jouer avec les =&gt; FFI: Foreign Function Interface</p>
<p>Je vous souhaite à tous de très bonnes fêtes de fin d'années,</p>
<p>Amitiés, Yvan</p>
<a class="header" href="print.html#big-project-guidelines-a-not-so-simple-ppm-image-manipulation-library" id="big-project-guidelines-a-not-so-simple-ppm-image-manipulation-library"><h1>Big project guidelines: a not so simple PPM image manipulation library</h1></a>
<p>Goals: Manipulating IO, Memory, Concurrent programming with threads and exposing Rust function
through Foreign Function Interface.</p>
<p>We will use the <a href="https://en.wikipedia.org/wiki/Netpbm_format">Portable Pixel Map</a> in binary format.</p>
<a class="header" href="print.html#lvl-0---warmup" id="lvl-0---warmup"><h2>Lvl 0 - Warmup</h2></a>
<ul>
<li>Create a new <code>ppm</code> Rust project as a library</li>
<li>Make a little readme present your team</li>
<li>Complete a little bit your Cargo.toml to add yourselves as author</li>
<li>Make sure that <code>cargo build</code> is working</li>
</ul>
<a class="header" href="print.html#lvl-1---struct" id="lvl-1---struct"><h2>Lvl 1 - Struct</h2></a>
<ul>
<li>Create a nice custom Rust data-structure <code>Image</code> to handle 24bits images.</li>
</ul>
<blockquote>
<p>Create first a <code>Pixel</code> structure to encode an RGB color.</p>
</blockquote>
<p>In a PPM file pixels il take 24bits; 8 bits (octet) par color:</p>
<ul>
<li>8 for red</li>
<li>8 for green</li>
<li>8 for blue</li>
</ul>
<a class="header" href="print.html#epic-functions-for-an-epic-pixels" id="epic-functions-for-an-epic-pixels"><h3>Epic Functions for an Epic <code>Pixels</code></h3></a>
<p>Because test are nices: Write a test for all the functions <a href="https://doc.rust-lang.org/book/ch11-01-writing-tests.html">doc</a>
Also, write a doc in rust style <em>Prof! I don't how to write doc!</em> <a href="https://doc.rust-lang.org/rust-by-example/meta/doc.html">short awnser</a>; <a href="https://doc.rust-lang.org/1.30.0/book/2018-edition/ch14-02-publishing-to-crates-io.html?highlight=document#making-useful-documentation-comments">long answer</a>
TL;DR writes how to use the function if it panic says it! make an example in the doc!</p>
<p>Warmups functions:</p>
<ul>
<li>Write a block <code>impl Pixel</code> for next questions</li>
<li>Write a nice constructor <code>fn new(red: u8, green: u8, blue: u8 -&gt; Pixel</code></li>
<li>Derive <code>Clone</code> and <code>Copy</code> because a Pixel is a tiny type who fits in a register.</li>
<li>Make functions <code>red</code>, <code>blue</code>, <code>green</code> to access each color easily</li>
<li>Make a <code>fn display(self) -&gt; String</code> to render a pixel in terminal</li>
<li>Carve a function <code>fn invert(&amp;self)</code> that inverts a pixel. Advise think <a href="https://doc.rust-lang.org/std/ops/trait.Not.html">bitwise</a><em>!</em> ;)</li>
</ul>
<p>Not so warmup:</p>
<ul>
<li>Make a function <code>fn eq(self, other: Pixel) -&gt; bool</code></li>
<li>Rewrite your code of <code>eq</code> function to implement <code>PartialEq</code> <a href="https://doc.rust-lang.org/std/cmp/trait.Eq.html">Doc PartialEq</a>!</li>
</ul>
<p>Advice: Read the doc again! :)</p>
<p>Need some engagement:</p>
<ul>
<li>Make a function <code>grayscale</code> who convert an RGB pixel to a grayscale pixel</li>
</ul>
<a class="header" href="print.html#lvl-2---image-manipulation" id="lvl-2---image-manipulation"><h2>Lvl 2 - Image manipulation</h2></a>
<p>Write a little <code>struct Image</code> that represents a struct you might need the following fields:</p>
<ul>
<li><code>Vec&lt;Pixel&gt;</code> to represent the pixels buffer</li>
<li><code>heigth</code> with type <code>usize</code></li>
<li><code>width</code> with type <code>usize</code></li>
<li>Maybe other fields?</li>
</ul>
<p>Now write some function to manipulate images!
A function <code>fn new_with_file(filename: &amp;Path) -&gt; Image</code> that read in text mode a ppm image you might need to write
the <code>.ppm</code> file format definition <a href="http://netpbm.sourceforge.net/doc/ppm.html">here</a>.</p>
<p>Write in a <code>impl Image</code> a function <code>fn save(filename: &amp;Path)</code> who saves your struct into a file.</p>
<p>An example file in text mode looks like:</p>
<pre><code class="language-text">P3
3 2
255
# The part above is the header
# &quot;P3&quot; means this is an RGB color image in ASCII
# &quot;3 2&quot; is the width and height of the image in pixels
# &quot;255&quot; is the maximum value for each color
# The part below is image data: RGB triplets
255 0   0   # red
0   255 0   # green
0   0   255 # blue
255 255 0   # yellow
255 255 255 # white
0   0   0   # black
</code></pre>
<ul>
<li>Create an <code>invert</code> function that inverts image colors (reuse your code!)</li>
<li>Create a <code>grayscale</code> function that makes image B&amp;W based on a filter color</li>
</ul>
<a class="header" href="print.html#buffering" id="buffering"><h3>Buffering</h3></a>
<p>Try to with really big files, improve performances. Maybe this doc pointer can help: <a href="https://doc.rust-lang.org/std/io/trait.BufRead.html">std::io::BufRead</a></p>
<blockquote>
<p><a href="https://mega.nz/#!dQNSyASY!Vk6rM8ZqxpbwvSyRFzHdYVB1Rh8p_6yKTDewtUxVe6Q">Here</a>
is a big <code>.ppm</code> the file of a Mandelbrot fractal for your tests!</p>
<p>You may want to open the file in Rust using a buffer to do the reading of the file and
image operations in parallel <a href="https://doc.rust-lang.org/std/io/trait.Read.html">https://doc.rust-lang.org/std/io/trait.Read.html</a></p>
<p><code>.ppm</code> file format has a simple syntax specified here:
<a href="http://netpbm.sourceforge.net/doc/ppm.html">http://netpbm.sourceforge.net/doc/ppm.html</a></p>
<p>The purpose of this level is to code a custom <code>.ppm</code> reading function in Rust!</p>
</blockquote>
<a class="header" href="print.html#bonus-binary-edition" id="bonus-binary-edition"><h3>Bonus binary edition</h3></a>
<ul>
<li>Prepare yourself to read the pixel part in binary mode write a <code>fn new_with_file_bin(Path filename) -&gt; Image</code></li>
</ul>
<blockquote>
<p>The whole purpose of this part is to do these computations using several threads,
and to develop a strategy to find a good compromise on the number of threads to assign
(e.g. one thread by pixel is maybe a bit too much ...)</p>
<p>Try to calls these functions from another language!</p>
</blockquote>
<a class="header" href="print.html#lvl-3---benchmarks" id="lvl-3---benchmarks"><h2>Lvl 3 - Benchmarks</h2></a>
<ul>
<li>Add benchmarks tests to measure your performances</li>
</ul>
<blockquote>
<p>Rust have off course a guide on this topic
<a href="https://doc.rust-lang.org/1.2.0/book/benchmark-tests.html">https://doc.rust-lang.org/1.2.0/book/benchmark-tests.html</a></p>
</blockquote>
<a class="header" href="print.html#going-further" id="going-further"><h2>Going further</h2></a>
<a class="header" href="print.html#lvl-4---unsafe---optional-c-fun-with-rust" id="lvl-4---unsafe---optional-c-fun-with-rust"><h3>Lvl 4 - Unsafe - Optional C fun with Rust</h3></a>
<ul>
<li>Create an <code>readPPM</code> function to read <code>.ppm</code> files</li>
<li>Create an <code>writePPM</code> function to read <code>.ppm</code> files</li>
</ul>
<blockquote>
<p>Use PPMA_IO: Portable Pixel Map (ASCII) Files Read and Write Utilities
<a href="https://people.sc.fsu.edu/%7Ejburkardt/c_src/ppma_io/ppma_io.html">https://people.sc.fsu.edu/~jburkardt/c_src/ppma_io/ppma_io.html</a></p>
<p>You may need to call C code in Rust using <code>unsafe</code> blocks.
If you want to know about some dark magics, read <a href="https://doc.rust-lang.org/nomicon/ffi.html">https://doc.rust-lang.org/nomicon/ffi.html</a></p>
<p>You can start with a simpler format like <code>.pbm</code> or <code>.pgm</code>.</p>
<p>You should make a static library and include it,
<a href="https://stackoverflow.com/questions/43826572/where-should-i-place-a-static-library-so-i-can-link-it-with-a-rust-program">this StackOverflow post</a>
could help!</p>
</blockquote>
<a class="header" href="print.html#lvl-5---ffi-for-the-fun-and-profit" id="lvl-5---ffi-for-the-fun-and-profit"><h3>Lvl 5 - FFI for the fun and profit</h3></a>
<p>Relatively easy:</p>
<ul>
<li>Make a <code>dummy()</code> function that return <code>42</code></li>
<li>Call this function in another language like Python using basic Foreign Function Interface FFI</li>
</ul>
<p><em>Note:</em></p>
<blockquote>
<p>The Rust doc has a really handy page on the subject:
<a href="https://doc.rust-lang.org/1.2.0/book/rust-inside-other-languages.html">https://doc.rust-lang.org/1.2.0/book/rust-inside-other-languages.html</a></p>
</blockquote>
<p>Somewhat harder:</p>
<ul>
<li>Exposes functions of your <code>ppm</code> crate to Python</li>
<li>Use <a href="https://github.com/PyO3/pyo3">PyO3</a> and <a href="https://github.com/PyO3/maturin">Maturin</a> read the README of the projects!</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        

                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                

                
            </nav>

        </div>


        <!-- Local fallback for Font Awesome -->
        <script>
            if (getComputedStyle(document.querySelector(".fa")).fontFamily !== "FontAwesome") {
                var link = document.createElement('link');
                link.rel = 'stylesheet';
                link.type = 'text/css';
                link.href = '_FontAwesome/css/font-awesome.css';
                document.head.insertBefore(link, document.head.firstChild)
            }
        </script>

        

        

        

        
        <script>
            document.addEventListener('DOMContentLoaded', function() {
                window.print();
            })
        </script>
        

        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS script -->
        

    </body>
</html>
